<div style="max-width: 800px; margin: 50px auto; padding: 20px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
  <h1>Load Test</h1>
  <p style="color: #666;">Test performance under concurrent load</p>

  <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin: 20px 0;">
    <strong>⚠️ Note:</strong> Running a <%= @duration %> second load test with <%= @threads %> threads.
  </div>

  <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
    <p><strong>Configuration:</strong></p>
    <ul>
      <li>Duration: <%= @duration %> seconds</li>
      <li>Concurrent Threads: <%= @threads %></li>
    </ul>

    <button onclick="runLoadTest()" style="background: #dc3545; color: white; padding: 12px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; margin-top: 10px;">
      Start Load Test
    </button>
  </div>

  <div id="result" style="display: none;">
    <div style="background: #e7f5e7; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745;">
      <h2>Results</h2>
      <pre id="result-data" style="background: white; padding: 15px; border-radius: 4px; overflow: auto;"></pre>
    </div>
  </div>

  <p style="margin-top: 30px;">
    <%= link_to "← Back to Monitoring Dashboard", demo_monitoring_dashboard_path, style: "color: #007bff; text-decoration: none;" %>
  </p>
</div>

<script>
async function runLoadTest() {
  const resultDiv = document.getElementById('result');
  const resultData = document.getElementById('result-data');

  resultDiv.style.display = 'block';
  resultData.textContent = 'Running load test...\nPlease wait...';

  try {
    const response = await fetch(window.location.pathname, {
      method: 'POST',
      headers: { 'Accept': 'application/json' }
    });

    const result = await response.json();
    resultData.textContent = JSON.stringify(result, null, 2);
  } catch (error) {
    resultData.textContent = 'Error: ' + error.message;
  }
}
</script>
